<!-- FORMULARIO -->
<form class="row g-3 mb-4" (ngSubmit)="productoEditando ? actualizarProducto() : agregarProducto()">
  <!-- Nombre del producto -->
  <div class="col-md-4">
    <input
      type="text"
      class="form-control"
      placeholder="Nombre del producto"
      [(ngModel)]="nombre"
      name="nombre"
      required
    />
  </div>

  <!-- Categoría -->
  <div class="col-md-3">
    <select
      class="form-select"
      [(ngModel)]="categoriaId"
      name="categoriaId"
      required
    >
      <option value="" disabled selected>Selecciona una categoría</option>
      <option *ngFor="let cat of categorias" [value]="cat.id">
        {{ cat.name }}
      </option>
    </select>
  </div>

  <!-- Cantidad -->
  <div class="col-md-2">
    <input
      type="number"
      class="form-control"
      placeholder="Cantidad"
      [(ngModel)]="cantidad"
      name="cantidad"
      required
      min="1"
    />
  </div>

  <!-- URL de la imagen -->
  <div class="col-md-3">
    <input
      type="url"
      class="form-control"
      placeholder="URL de imagen"
      [(ngModel)]="imagenUrl"
      name="imagenUrl"
    />
  </div>

  <!-- Botón -->
  <div class="col-md-12 text-end">
    <button type="submit" class="btn btn-primary">
      {{ productoEditando ? 'Actualizar producto' : 'Agregar producto' }}
    </button>
    <button *ngIf="productoEditando" type="button" class="btn btn-secondary ms-2" (click)="cancelarEdicion()">
      Cancelar
    </button>
  </div>
</form>

<!-- Mensajes -->
<div *ngIf="mensajeExito" class="alert alert-success text-center py-2">
  {{ mensajeExito }}
</div>

<div *ngIf="mensajeError" class="alert alert-danger text-center py-2">
  {{ mensajeError }}
</div>

<!-- LISTA DE PRODUCTOS -->
<div class="product-list scroll-container p-3">
  <div
    *ngFor="let producto of productos"
    class="card card-option mb-3 p-3 d-flex flex-md-row align-items-center justify-content-between"
  >
    <div>
      <h5 class="text-white m-0">{{ producto.name }}</h5>
      <small class="text-info">
        ID Categoría: {{ producto.category_id }} - {{ getNombreCategoria(producto.category_id) }}
      </small><br />
      <small class="text-warning">Cantidad: {{ producto.quantity }}</small><br />

      <!-- Mostrar imagen -->
      <img
        *ngIf="producto.imageUrl"
        [src]="producto.imageUrl"
        alt="{{ producto.name }}"
        class="img-thumbnail mt-2"
        style="max-height: 120px;"
      />
    </div>

    <div class="mt-2 mt-md-0">
      <button class="btn btn-success btn-sm me-2" (click)="cargarProducto(producto)">
        Editar
      </button>
      <button class="btn btn-danger btn-sm" (click)="removerProducto(producto)">
        Remover
      </button>
    </div>
  </div>
</div>
